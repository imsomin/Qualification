# SQL응용

## (7-1) 데이터베이스 기본

### 1. 트랜잭션(Transaction)
- 인가받지 않은 사용자로부터 데이터를 보장하기 위해 DBMS가 가져야 하는 특성이자, 데이터베이스 시스템에서 하나의 논리적 기능을 정상적으로 수행하기 위한 작업의 기본 단위
- 특성 : 원자성(Rollback, Commit), 일관성(무결성 제약조건), 격리성(Serializable), 영속성(회복기법)
- 상태
  - 활동 상태(Active): 초기 상태, 트랜잭션이 실행 중일 때 가지는 상태 
  - 부분 완료 상태(Partially Committed): 마지막 명령문이 실행된 후에 가지는 상태
  - 완료 상태(Committed): 트랜잭션이 성공적으로 완료된 후 가지는 상태
  - 실패 상태(Failed): 정상적인 실행이 더 이상 진행될 수 없을 때 가지는 상태
  - 철회 상태(Aborted): 트랜잭션이 취소되고 데이터베이스가 트랜잭션 시작 전 상태로 환원된 상태


### 1-1. 트랜잭션 제어
- 트랜잭션 제어언어는 TCL(Transaction Control Language)이라고 하며, 트랜잭션의 결과를 허용하거나 취소하는 목적으로 사용되는 언어를 지칭한다.
- TCL 명령어
  - 커밋: 트랜잭션 확정
  - 롤백: 트랜잭션 취소
  - 체크포인트: 저장 시기 설정


### 1-2. 병행 제어(일관성 주요 기법)
- 병행제어(Concurrency Control)는 다수 사용자 환경에서 여러 트랜잭션을 수행할 때, 데이터베이스 일관성 유지를 위해 상호작용을 제어하는 기법이다.
- 목적: 데이터베이스 공유 최대화, 시스템 활용도 최대화, 데이터베이스 일관성 유지, 사용자에 대한 응답시간 최소화
- 병행제어 미보장 시 문제점
  - 갱신 손실(Lost Update)
  - 현황 파악오류(Dirty Read)
  - 모순성(Inconsistency)
  - 연쇄복귀(Cascading Rollback)
- 병행제어 기법의 종류
  - 로킹(Locking): 트랜잭션의 순차적 진행을 보장하는 직렬화 기법
    - 로킹의 특징
      - 데이터베이스, 파일, 레코드 등을 로킹 단위가 될 수 있음
      - 로킹 단위가 작아지면 데이터베이스 공유도가 증가
      - 로킹 단위가 작아지면 로킹 오버헤드 증가
      - 한꺼번에 로킹할 수 있는 객체의 크기를 로킹 단위라고 함
  - 낙관적 검증: 트랜잭션이 어떠한 검증 수행 없이 수행된 뒤, 트랜잭션이 종료 시 검증을 수행하여 데이터베이스에 반영하는 기법
  - 타임 스탬프 순서(Time Stamp Ordering): 트랜잭션과 트랜잭션이 읽거나 갱신한 데이터에 대해, 트랜잭션이 실행되기 전 타임 스탬프를 부여하여 부여된 시간에 따라 트랜잭션을 수행하는 기법
  - 다중버전 동시성 제어(MVCC; Multi Version Concurrency Control): 트랜잭션의 타임스탬프와 접근하려는 데이터의 타임스탬프를 비교하여 직렬가능성이 보장되는 적절한 버전을 선택하여 접근하도록 하는 기법

